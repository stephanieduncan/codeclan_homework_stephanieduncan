---
title: "R Notebook"
output: html_notebook
---
1. Load in the libraries you need, and look at the backpack data. Take note of variable names and dimensions.
```{r}
library(tidyverse)
backpack <- CodeClanData::backpack
```

```{r}
names(backpack)
```
```{r}
dim(backpack)
```

2. What is the distribution of backpack weights that students are carrying? Choose an appropriate graph to show the distribution.

```{r}
ggplot(backpack) +
  geom_bar(aes(x = backpack_weight, fill = sex), color = "white") +
  labs(
    x = "Backpack Weight (kg)",
    y = "Count of Backpacks per Weight",
    title = "Weight of Backpacks Carried by Students",
    fill = "Sex"
  ) +
  scale_x_continuous(breaks = c(0, 5, 10, 15, 20, 25, 30, 35, 40)) +
  scale_y_continuous(breaks = c(0, 2, 4, 6, 8, 10, 12, 14))

```
3. Are there differences in backpack weight between sex?
The data shows more females carrying bags than males. There are more males carrying bags over 25kg than females.

4. What is the relationship between body weight and backpack weight?
```{r}
ggplot(backpack) +
  geom_col(aes(x = body_weight, y = backpack_weight), color = "steel blue") +
  labs(
    x = "Body Weight",
    y = "Backpack  Weight",
    title = "Weight of Backpacks Carried by Body Weight"
  ) 
#The graph shows right-skewed distribution.
```
5. Is this relationship different between men and women? Choose an appropriate plot and interpret your findings.
```{r}
ggplot(backpack) +
  geom_col(aes(x = body_weight, y = backpack_weight, fill = sex, position = "dodge")) +
  labs(
    x = "Body Weight",
    y = "Backpack  Weight",
    title = "Weight of Backpacks Carried by Body Weight",
fill = "Sex")

#Females carry backpacks which are lighter than those carried by males
```

6. What proportion of students report back pain?
```{r}
ggplot(backpack) +
  geom_bar(aes(x = back_problems, fill = sex), position = "fill") +
   labs(
    x = "Back Problems",
    title = "Proportion of Students with Back Problems",
fill = "Sex")
```



7. Is this proportion different between men and women?
```{r}
ggplot(backpack) +
  geom_bar(aes(x = back_problems, fill = sex), position = "fill") +
   labs(
    x = "Back Problems",
    title = "Proportion of Students with Back Problems",
fill = "Sex") +
  scale_fill_brewer(palette = "Set3")
```

8.
Now youâ€™ve investigated your data separately, create plots to describe the relationship between backpack weight, body weight, gender and reported backpain.

Try both backpack_weight and body_weight as well as the ratio.

```{r}
ggplot(backpack) + 
  geom_histogram(aes(x = backpack_weight, fill = sex), col = "white") + 
  facet_wrap(~sex ~back_problems) +
  labs(
    x = "Backpack Weight",
title = "Reported Back Pain against Weight of Backpacks carried by Students") +
   scale_fill_brewer(palette = "Set2")
  
```
